# Dothome API 설치 가이드

## 📌 서버 정보
- **기본 도메인**: chan222k.dothome.co.kr
- **연결 도메인**: ch4n.co.kr (SSL 인증서 적용됨)
- **MySQL ID**: chan222k
- **phpMyAdmin**: https://chan222k.dothome.co.kr/myadmin

## 🔧 설치 순서

### 1. MySQL 비밀번호 설정
`api/config.php` 파일의 19번째 줄에서 비밀번호를 실제 MySQL 비밀번호로 변경:
```php
$password = 'your_password'; // 실제 MySQL 비밀번호로 변경
```

### 2. FTP로 파일 업로드
Dothome 파일매니저 또는 FTP 클라이언트를 사용하여:

1. 호스팅 루트 디렉토리에 `api` 폴더 생성
2. 다음 PHP 파일들을 `api` 폴더에 업로드:
   - `config.php`
   - `save-visitor.php`
   - `get-visitors.php`

폴더 구조:
```
/html (Dothome 루트)
  /api
    - config.php
    - save-visitor.php
    - get-visitors.php
```

### 3. 데이터베이스 테이블 자동 생성
첫 방문자가 접속하면 자동으로 `visitors` 테이블이 생성됩니다.

수동으로 생성하려면 phpMyAdmin에서:
```sql
CREATE TABLE IF NOT EXISTS visitors (
    id INT AUTO_INCREMENT PRIMARY KEY,
    visitor_id VARCHAR(255) UNIQUE,
    ip VARCHAR(45),
    city VARCHAR(100),
    country VARCHAR(100),
    browser VARCHAR(100),
    os VARCHAR(100),
    connection_type VARCHAR(50),
    first_visit TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    last_visit TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    visit_count INT DEFAULT 1,
    INDEX idx_ip (ip),
    INDEX idx_last_visit (last_visit)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
```

### 4. React 앱 빌드 및 배포
```bash
npm run build
```
빌드된 `dist` 폴더 내용을 Dothome에 업로드

## 📡 API 엔드포인트

### 방문자 저장
- **URL**: `https://ch4n.co.kr/api/save-visitor.php`
- **Method**: POST
- **Body**: JSON 형식의 방문자 정보

### 방문자 조회
- **URL**: `https://ch4n.co.kr/api/get-visitors.php`
- **Parameters**:
  - `limit`: 가져올 방문자 수 (기본: 100)
  - `active`: true일 경우 활성 방문자만 (최근 10분)

## ✅ 확인사항

1. **CORS 설정**: PHP 파일에 이미 설정되어 있음
2. **SSL**: ch4n.co.kr 도메인 사용 시 HTTPS 자동 적용
3. **에러 로그**: PHP 에러는 서버 로그에 기록됨
4. **보안**: SQL 인젝션 방지를 위한 준비된 문장 사용

## 🔍 테스트

1. 브라우저에서 `https://ch4n.co.kr` 접속
2. 개발자 도구 콘솔에서 API 호출 확인
3. Admin 페이지에서 방문자 목록 확인

## ⚠️ 주의사항

- **비밀번호 보안**: config.php 파일의 비밀번호는 절대 공개하지 마세요
- **백업**: 정기적으로 데이터베이스 백업 권장
- **용량 관리**: 방문자가 많을 경우 오래된 데이터 정리 필요